!function(t,i){function e(i){if(t.extend(this,l,i),this.pages.length<=0)throw new Error("target para not pass");this.target=this.pages.eq(0).parent(),this.length=this.pages.length,this.moveTo=e.prototype.moveTo,this.index=0,this.curPage=this.pages.eq(this.index),this.timer=null,r=this.gestureFollowing,("vertical"===this.direction||"v"===this.direction)&&(this.direction="v"),("horizontal"===this.direction||"h"===this.direction)&&(this.direction="h"),this.length<=1||this._init()}var n,s,a,o,r,h,c,l={direction:"vertical",currentClass:"current",gestureFollowing:!1,hasDot:!1,rememberLastVisited:!1,preventDefault:!0,animationPlayOnce:!1,dev:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},oninit:function(){},onbeforechange:function(){},onchange:function(){}},d=document.documentElement.clientWidth,u=document.documentElement.clientHeight;e.prototype={_init:function(){var i=this;this.target.css("-webkit-transition","-webkit-transform 0.5s ease"),this.pages.each(function(){var i=t(this),e=i.wrapInner('<div class="PageSlider__wraper"></div>').find(".PageSlider__wraper"),n=e.height();n>u&&(i.data("height",n),i.css("overflow","auto")),e.children().unwrap()}),"h"===this.direction&&(this.target.css("position","relative"),this.pages.each(function(i){t(this).css({position:"absolute",left:100*i+"%",top:0})})),this.hasDot&&this._createDot(),i._bindAnimation(),this.target.on("touchstart",function(t){i._startHandle(t)}),this.target.on("touchmove",function(t){i._moveHandle(t)}),this.target.on("touchend",function(t){i._endHandle(t)}),this.rememberLastVisited&&(this.lastVisitedIndex=this._getLastVisited()),this.target.css("-webkit-transform","translate(0, 0)"),this.pages.eq(0).addClass(this.currentClass),this.oninit.call(this),this._dev()},_startHandle:function(t){var i=t.touches[0];return"running"===a?void t.preventDefault():(o="v"===this.direction?i.clientY:i.clientX,n=this.curPage.data("lock-next"),s=this.curPage.data("lock-prev"),this.curPage[0].pageScrollHeight=this.curPage.data("height"),this.curPage[0].pageScrollHeight&&(r&&(this.gestureFollowing=!1),this.preventDefault=!1,c=u+this.curPage.scrollTop()),void(this.gestureFollowing&&(h=-this.index*("v"===this.direction?u:d))))},_moveHandle:function(t){var i,e,r=t.changedTouches[0];return"running"===a?void t.preventDefault():(e="v"===this.direction?r.clientY:r.clientX,i=e-o,this.curPage[0].pageScrollHeight&&(i>0&&c===u&&t.preventDefault(),0>i&&c===this.curPage[0].pageScrollHeight&&t.preventDefault()),this.gestureFollowing?this.index<=0&&e>o||this.index>=this.length-1&&o>e?void t.preventDefault():i>0&&s||0>i&&n?void t.preventDefault():(i=h+i+"px",this._removeTransition(),"v"===this.direction?this.target.css("-webkit-transform","translate(0, "+i+")"):this.target.css("-webkit-transform","translate("+i+", 0)"),void this._preventDefault(t)):void this._preventDefault(t))},_endHandle:function(t){var i,e,r=t.changedTouches[0];if("running"===a)return void t.preventDefault();if(e="v"===this.direction?r.clientY:r.clientX,i=e-o,this._setTransition(),i>0&&("v"===this.direction?this.onSwipeDown.call(this):this.onSwipeRight.call(this),!s)){if(this.curPage[0].pageScrollHeight&&c>u)return;i>20?this.prev():this.moveTo(this.index)}if(0>i&&("v"===this.direction?this.onSwipeUp.call(this):this.onSwipeLeft.call(this),!n)){if(this.curPage[0].pageScrollHeight&&c<this.curPage[0].pageScrollHeight)return;-20>i?this.next():this.moveTo(this.index)}},moveTo:function(t,i){var e,n=this;return a="running",i=i||!1,t>=this.length||0>t?void(a="end"):(i&&this._removeTransition(),this.onbeforechange.call(this),"v"===this.direction&&(e=100*-t+"%",this.target.css("-webkit-transform","translate(0, "+e+")")),"h"===this.direction&&(e=100*-t+"%",this.target.css("-webkit-transform","translate("+e+", 0)")),clearTimeout(this.timer),void(this.timer=setTimeout(function(){n._currentClass(t),n.prevIndex=n.index,n.index=t,n.onchange.call(n),i&&n._setTransition(),n.curPage&&n.curPage[0].pageScrollHeight&&(r&&(n.gestureFollowing=!0),n.preventDefault=!0,n.curPage.scrollTop(0)),n.curPage=n.pages.eq(n.index),n.rememberLastVisited&&n._saveLastVisited(),a="end",clearTimeout(this.timer)},500)))},prev:function(){this.moveTo(this.index-1)},next:function(){this.moveTo(this.index+1)},_setTransition:function(){this.target.css("-webkit-transition","-webkit-transform 0.5s ease")},_removeTransition:function(){this.target.css("-webkit-transition","none")},_currentClass:function(t){var i=this.currentClass;this.pages.eq(t).addClass(i),t===this.index||this.animationPlayOnce||this.pages.eq(this.index).removeClass(i)},_createDot:function(){for(var i="",e=0;e<this.length;e++)i+="<li>"+(e+1)+"</li>";t(i).appendTo(this.target).wrapAll('<ul class="dot-list">')},_saveLastVisited:function(){var t=i.localStorage;t&&t.setItem("pageSliderIndex",this.index)},_getLastVisited:function(){var t=i.localStorage;return t?(this.cacheIndex=t.getItem("pageSliderIndex"),parseInt(this.cacheIndex)):void 0},_bindAnimation:function(){var i=this,e="<style>";t("[data-animation]").each(function(n){var s=t(this),a=s.data("animation"),o=a.name,r=a.duration||500,h=a.delay||0,c=a["timing-function"]||"ease",l=a["fill-mode"]||"both",d=a["iteration-count"]||1;s.data("animationid",++n),e+="."+i.currentClass+' [data-animationid="'+n+'"]{-webkit-animation-name: '+o+";-webkit-animation-duration: "+r+"ms;-webkit-animation-delay: "+h+"ms;-webkit-animation-timing-function: "+c+";-webkit-animation-fill-mode: "+l+";-webkit-animation-iteration-count: "+d+";}"}),t("head").eq(0).append(e)},_preventDefault:function(t){this.preventDefault&&t.preventDefault()},_dev:function(){this.dev!==!1&&this.moveTo(this.dev,!0)}},i.PageSlider=e}(Zepto,window),"function"==typeof define&&define.amd&&define("PageSlider",[],function(){return PageSlider});